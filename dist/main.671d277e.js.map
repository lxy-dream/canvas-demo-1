{"version":3,"sources":["main.js"],"names":["canvas","document","getElementById","context","getContext","eraser","brush","reSetCanvas","save","penDetail","aColorBtn","getElementsByClassName","undo","redo","range1","range2","showOpacity","querySelector","closeBtn","querySelectorAll","eraserEnabled","activeBgColor","ifPop","lWidth","opacity","strokeColor","radius","autoSetSize","setCanvasBg","listenToUser","canvasSetSize","imgData","getImageData","width","height","pageWidth","documentElement","clientWidth","pageHeight","clientHeight","putImageData","window","onresize","painting","lastPoint","x","undefined","y","body","ontouchstart","e","x1","touches","clientX","y1","clientY","globalCompositeOperation","beginPath","arc","Math","PI","clip","clearRect","restore","ontouchmove","x2","y2","moveHandler","newPoint","drawLine","ontouchend","canvasDraw","onmousedown","onmousemove","onmouseup","asin","sin","atan","acos","cos","x3","y3","x4","y4","x5","y5","x6","y6","moveTo","lineTo","closePath","lineWidth","lineCap","lineJoin","stroke","onclick","classList","add","remove","canvasHistory","color","fillStyle","fillRect","imgUrl","toDataURL","saveA","createElement","appendChild","href","download","Date","getTime","target","click","onchange","thickness","style","transform","parseInt","value","getColor","i","length","activeColor","backgroundColor","strokeStyle","step","push","canvasUndo","canvasPic","Image","src","onload","drawImage","alert","canvasRedo","index","btnParent","parentElement","onbeforeunload"],"mappings":"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","file":"main.671d277e.js","sourceRoot":"..\\src","sourcesContent":["let canvas = document.getElementById('canvas');\r\nlet context = canvas.getContext('2d');\r\nlet eraser = document.getElementById('eraser');\r\nlet brush = document.getElementById('brush');\r\nlet reSetCanvas = document.getElementById(\"clear\");\r\nlet save = document.getElementById(\"save\");\r\n\r\nlet penDetail = document.getElementById(\"penDetail\");\r\nlet aColorBtn = document.getElementsByClassName(\"color-item\");\r\nlet undo = document.getElementById(\"undo\");\r\nlet redo = document.getElementById(\"redo\");\r\n\r\n\r\nlet range1 = document.getElementById('range1');\r\nlet range2 = document.getElementById('range2');\r\nlet showOpacity = document.querySelector('.showOpacity');\r\nlet closeBtn = document.querySelectorAll('.closeBtn');\r\nlet eraserEnabled = false;\r\nlet activeBgColor = '#fff';\r\nlet ifPop = false;\r\nlet lWidth = 2;\r\nlet opacity = 1;\r\nlet strokeColor = 'rgba(0,0,0,1)';\r\nlet radius = 5;\r\n\r\n\r\nautoSetSize();\r\n\r\nsetCanvasBg('white');\r\n\r\nlistenToUser();\r\n\r\n\r\n/* 下面是实现相关效果的函数 */\r\n\r\nfunction autoSetSize() {\r\n    canvasSetSize();\r\n\r\n    function canvasSetSize() {\r\n        // 把变化之前的画布内容copy一份，然后重新画到画布上\r\n        let imgData = context.getImageData(0, 0, canvas.width, canvas.height);\r\n        let pageWidth = document.documentElement.clientWidth;\r\n        let pageHeight = document.documentElement.clientHeight;\r\n\r\n        canvas.width = pageWidth;\r\n        canvas.height = pageHeight;\r\n        context.putImageData(imgData, 0, 0);\r\n    }\r\n\r\n    window.onresize = function () {\r\n        canvasSetSize();\r\n    }\r\n}\r\n\r\n// 监听用户鼠标事件\r\nfunction listenToUser() {\r\n    // 定义一个变量初始化画笔状态\r\n    let painting = false;\r\n    // 记录画笔最后一次的位置\r\n    let lastPoint = {\r\n        x: undefined,\r\n        y: undefined\r\n    };\r\n\r\n    if (document.body.ontouchstart !== undefined) {\r\n        canvas.ontouchstart = function (e) {\r\n            painting = true;\r\n            let x1 = e.touches[0].clientX;\r\n            let y1 = e.touches[0].clientY;\r\n            if (eraserEnabled) { //要使用eraser\r\n                context.save();\r\n                context.globalCompositeOperation = \"destination-out\";\r\n                context.beginPath();\r\n                radius = (lWidth / 2) > 5 ? (lWidth / 2) : 5;\r\n                context.arc(x1, y1, radius, 0, 2 * Math.PI);\r\n                context.clip();\r\n                context.clearRect(0, 0, canvas.width, canvas.height);\r\n                context.restore();\r\n                lastPoint = {\r\n                    'x': x1,\r\n                    'y': y1\r\n                }\r\n            } else {\r\n                lastPoint = {\r\n                    'x': x1,\r\n                    'y': y1\r\n                }\r\n            }\r\n        };\r\n        canvas.ontouchmove = function (e) {\r\n            let x1 = lastPoint['x'];\r\n            let y1 = lastPoint['y'];\r\n            let x2 = e.touches[0].clientX;\r\n            let y2 = e.touches[0].clientY;\r\n            if (!painting) {\r\n                return\r\n            }\r\n            if (eraserEnabled) {\r\n                moveHandler(x1, y1, x2, y2);\r\n                //记录最后坐标\r\n                lastPoint['x'] = x2;\r\n                lastPoint['y'] = y2;\r\n            } else {\r\n                let newPoint = {\r\n                    'x': x2,\r\n                    'y': y2\r\n                };\r\n                drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\r\n                lastPoint = newPoint;\r\n            }\r\n        };\r\n\r\n        canvas.ontouchend = function () {\r\n            painting = false;\r\n            canvasDraw();\r\n        }\r\n    } else {\r\n        // 鼠标按下事件\r\n        canvas.onmousedown = function (e) {\r\n            painting = true;\r\n            let x1 = e.clientX;\r\n            let y1 = e.clientY;\r\n            if (eraserEnabled) { //要使用eraser\r\n                //鼠标第一次点下的时候擦除一个圆形区域，同时记录第一个坐标点\r\n                context.save();\r\n                context.globalCompositeOperation = \"destination-out\";\r\n                context.beginPath();\r\n                radius = (lWidth / 2) > 5 ? (lWidth / 2) : 5;\r\n                context.arc(x1, y1, radius, 0, 2 * Math.PI);\r\n                context.clip();\r\n                context.clearRect(0, 0, canvas.width, canvas.height);\r\n                context.restore();\r\n                lastPoint = {\r\n                    'x': x1,\r\n                    'y': y1\r\n                }\r\n            } else {\r\n                lastPoint = {\r\n                    'x': x1,\r\n                    'y': y1\r\n                }\r\n            }\r\n        }\r\n\r\n        // 鼠标移动事件\r\n        canvas.onmousemove = function (e) {\r\n            let x1 = lastPoint['x'];\r\n            let y1 = lastPoint['y'];\r\n            let x2 = e.clientX;\r\n            let y2 = e.clientY;\r\n            if (!painting) {\r\n                return\r\n            }\r\n            if (eraserEnabled) {\r\n                moveHandler(x1, y1, x2, y2);\r\n                //记录最后坐标\r\n                lastPoint['x'] = x2;\r\n                lastPoint['y'] = y2;\r\n            } else {\r\n                let newPoint = {\r\n                    'x': x2,\r\n                    'y': y2\r\n                };\r\n                drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\r\n                lastPoint = newPoint;\r\n            }\r\n        }\r\n\r\n        // 鼠标松开事件\r\n        canvas.onmouseup = function () {\r\n            painting = false;\r\n            canvasDraw();\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n// \r\nfunction moveHandler(x1, y1, x2, y2) {\r\n    //获取两个点之间的剪辑区域四个端点\r\n    var asin = radius * Math.sin(Math.atan((y2 - y1) / (x2 - x1)));\r\n    var acos = radius * Math.cos(Math.atan((y2 - y1) / (x2 - x1)))\r\n    var x3 = x1 + asin;\r\n    var y3 = y1 - acos;\r\n    var x4 = x1 - asin;\r\n    var y4 = y1 + acos;\r\n    var x5 = x2 + asin;\r\n    var y5 = y2 - acos;\r\n    var x6 = x2 - asin;\r\n    var y6 = y2 + acos;\r\n\r\n    //保证线条的连贯，所以在矩形一端画圆\r\n    context.save()\r\n    context.beginPath()\r\n    context.globalCompositeOperation = \"destination-out\";\r\n    radius = (lWidth / 2) > 5 ? (lWidth / 2) : 5;\r\n    context.arc(x2, y2, radius, 0, 2 * Math.PI);\r\n    context.clip()\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    context.restore();\r\n\r\n    //清除矩形剪辑区域里的像素\r\n    context.save()\r\n    context.beginPath()\r\n    context.globalCompositeOperation = \"destination-out\";\r\n    context.moveTo(x3, y3);\r\n    context.lineTo(x5, y5);\r\n    context.lineTo(x6, y6);\r\n    context.lineTo(x4, y4);\r\n    context.closePath();\r\n    context.clip();\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    context.restore();\r\n}\r\n\r\n\r\n// 画线函数\r\nfunction drawLine(x1, y1, x2, y2) {\r\n    context.beginPath();\r\n    context.lineWidth = lWidth;\r\n    // context.strokeStyle = strokeColor;\r\n    // context.globalAlpha = opacity;\r\n    // 设置线条末端样式。\r\n    context.lineCap = \"round\";\r\n    // 设定线条与线条间接合处的样式\r\n    context.lineJoin = \"round\";\r\n    context.moveTo(x1, y1);\r\n    context.lineTo(x2, y2);\r\n    context.stroke();\r\n    context.closePath();\r\n}\r\n\r\n// 点击橡皮檫\r\neraser.onclick = function () {\r\n    eraserEnabled = true;\r\n    eraser.classList.add('active');\r\n    brush.classList.remove('active');\r\n}\r\n// 点击画笔\r\nbrush.onclick = function () {\r\n    eraserEnabled = false;\r\n    brush.classList.add('active');\r\n    eraser.classList.remove('active');\r\n    if (!ifPop) {\r\n        // 弹出框\r\n        penDetail.classList.add('active');\r\n    } else {\r\n        penDetail.classList.remove('active');\r\n    }\r\n    ifPop = !ifPop;\r\n}\r\n\r\n// 实现清屏\r\nreSetCanvas.onclick = function () {\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    setCanvasBg('white');\r\n    canvasHistory = [];\r\n    undo.classList.remove('active');\r\n    redo.classList.remove('active');\r\n}\r\n\r\n// 重新设置canvas背景颜色\r\nfunction setCanvasBg(color) {\r\n    context.fillStyle = color;\r\n    context.fillRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\n// 下载图片\r\nsave.onclick = function () {\r\n    let imgUrl = canvas.toDataURL('image/png');\r\n    let saveA = document.createElement('a');\r\n    document.body.appendChild(saveA);\r\n    saveA.href = imgUrl;\r\n    saveA.download = 'mypic' + (new Date).getTime();\r\n    saveA.target = '_blank';\r\n    saveA.click();\r\n}\r\n\r\n\r\nrange1.onchange = function () {\r\n    thickness.style.transform = 'scale(' + (parseInt(range1.value)) + ')';\r\n    lWidth = parseInt(range1.value * 2);\r\n}\r\n\r\nrange2.onchange = function () {\r\n    opacity = 1 - parseInt(this.value) / 10;\r\n    if (opacity !== 0) {\r\n        showOpacity.style.opacity = opacity;\r\n    }\r\n}\r\n\r\n// 改变画笔颜色\r\ngetColor();\r\n\r\nfunction getColor() {\r\n    for (let i = 0; i < aColorBtn.length; i++) {\r\n        aColorBtn[i].onclick = function (e) {\r\n            // e.stopPropagation();\r\n            for (let i = 0; i < aColorBtn.length; i++) {\r\n                aColorBtn[i].classList.remove(\"active\");\r\n                this.classList.add(\"active\");\r\n                activeColor = this.style.backgroundColor;\r\n                context.fillStyle = activeColor;\r\n                context.strokeStyle = activeColor;\r\n            }\r\n            penDetail.classList.remove('active');\r\n            ifPop = false;\r\n        }\r\n    }\r\n}\r\n\r\n// 实现撤销和重做的功能\r\nlet canvasHistory = [];\r\nlet step = -1;\r\n\r\n// 绘制方法\r\nfunction canvasDraw() {\r\n    step++;\r\n    if (step < canvasHistory.length) {\r\n        canvasHistory.length = step; // 截断数组\r\n    }\r\n    // 添加新的绘制到历史记录\r\n    canvasHistory.push(canvas.toDataURL());\r\n    if (step > 0) {\r\n        undo.classList.add('active');\r\n    }\r\n}\r\n\r\n// 撤销方法\r\nfunction canvasUndo() {\r\n    if (step > 0) {\r\n        step--;\r\n        let canvasPic = new Image();\r\n        canvasPic.src = canvasHistory[step];\r\n        canvasPic.onload = function () {\r\n            context.drawImage(canvasPic, 0, 0);\r\n        }\r\n        undo.classList.add('active');\r\n        redo.classList.add('active');\r\n    } else {\r\n        undo.classList.remove('active');\r\n        alert('不能再继续撤销了');\r\n    }\r\n}\r\n// 重做方法\r\nfunction canvasRedo() {\r\n    if (step < canvasHistory.length - 1) {\r\n        step++;\r\n        let canvasPic = new Image();\r\n        canvasPic.src = canvasHistory[step];\r\n        canvasPic.onload = function () {\r\n            context.drawImage(canvasPic, 0, 0);\r\n        }\r\n        // redo.classList.add('active');\r\n    } else {\r\n        redo.classList.remove('active')\r\n        alert('已经是最新的记录了');\r\n    }\r\n}\r\nundo.onclick = function () {\r\n    canvasUndo();\r\n}\r\nredo.onclick = function () {\r\n    canvasRedo();\r\n}\r\n\r\n\r\n\r\nfor (let index = 0; index < closeBtn.length; index++) {\r\n    closeBtn[index].onclick = function (e) {\r\n        let btnParent = e.target.parentElement;\r\n        btnParent.classList.remove('active');\r\n    }\r\n\r\n}\r\n\r\nwindow.onbeforeunload = function () {\r\n    return \"Reload site?\";\r\n};"]}